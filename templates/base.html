<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Management - {% block page_title %}Dashboard{% endblock %}</title>
    
    <!-- Boxicons -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS UnifiÃ© -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    
    {% block extra_css %}{% endblock %}
</head>

<body>
<div class="app">
    
    <!-- SIDEBAR AMÃ‰LIORÃ‰E AVEC SECTIONS -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">ðŸŽ“ School</div>
        </div>

        <nav class="sidebar-nav">
            <!-- SECTION MAIN -->
            <div class="nav-section">
                <span class="section-label">MAIN</span>
                <a href="{{ url_for('dashboard') }}" class="nav-item {% if request.endpoint == 'dashboard' %}active{% endif %}">
                    <i class='bx bxs-dashboard'></i>
                    <span>Dashboard</span>
                </a>
            </div>

            <!-- SECTION ACADEMIC -->
            <div class="nav-section">
                <span class="section-label">ACADEMIC</span>
                <a href="{{ url_for('students') }}" class="nav-item {% if request.endpoint == 'students' %}active{% endif %}">
                    <i class='bx bxs-user'></i>
                    <span>Students</span>
                    <span class="nav-badge">245</span>
                </a>
                <a href="{{ url_for('teachers') }}" class="nav-item {% if request.endpoint == 'teachers' %}active{% endif %}">
                    <i class='bx bxs-chalkboard'></i>
                    <span>Teachers</span>
                    <span class="nav-badge">20</span>
                </a>
                <a href="{{ url_for('classes') }}" class="nav-item {% if request.endpoint == 'classes' %}active{% endif %}">
                    <i class='bx bxs-group'></i>
                    <span>Classes</span>
                    <span class="nav-badge">12</span>
                </a>
                <a href="{{ url_for('subjects') }}" class="nav-item {% if request.endpoint == 'subjects' %}active{% endif %}">
                    <i class='bx bxs-book'></i>
                    <span>Subjects</span>
                    <span class="nav-badge">24</span>
                </a>
            </div>

            <!-- SECTION FINANCE -->
            <div class="nav-section">
                <span class="section-label">FINANCE</span>
                <a href="{{ url_for('fees') }}" class="nav-item {% if request.endpoint == 'fees' %}active{% endif %}">
                    <i class='bx bxs-wallet'></i>
                    <span>Fees</span>
                    <span class="nav-badge badge-warning">3</span>
                </a>
            </div>

            <!-- SECTION MANAGEMENT -->
            <div class="nav-section">
                <span class="section-label">MANAGEMENT</span>
                <a href="{{ url_for('enrollments') }}" class="nav-item {% if request.endpoint == 'enrollments' %}active{% endif %}">
                    <i class='bx bx-list-check'></i>
                    <span>Enrollments</span>
                    <span class="nav-badge">12</span>
                </a>
                <a href="{{ url_for('results') }}" class="nav-item {% if request.endpoint == 'results' %}active{% endif %}">
                    <i class='bx bx-bar-chart-alt-2'></i>
                    <span>Results</span>
                    <span class="nav-badge"></span>
                </a>
                <a href="{{ url_for('timetable') }}" class="nav-item {% if request.endpoint == 'timetable' %}active{% endif %}">
                    <i class='bx bxs-calendar'></i>
                    <span>Timetable</span>
                </a>
                <a href="{{ url_for('rooms') }}" class="nav-item {% if request.endpoint == 'rooms' %}active{% endif %}">
                    <i class='bx bxs-door-open'></i>
                    <span>Rooms</span>
                    <span class="nav-badge">6</span>
                </a>
            </div>

            <!-- SECTION ACCOUNT -->
            <div class="nav-section">
                <span class="section-label">ACCOUNT</span>
                <a href="{{ url_for('profile') }}" class="nav-item {% if request.endpoint == 'profile' %}active{% endif %}">
                    <i class='bx bxs-user-circle'></i>
                    <span>Profile</span>
                </a>
                <a href="{{ url_for('settings') }}" class="nav-item {% if request.endpoint == 'settings' %}active{% endif %}">
                    <i class='bx bxs-cog'></i>
                    <span>Settings</span>
                </a>
                <a href="{{ url_for('logout') }}" class="nav-item logout">
                    <i class='bx bx-log-out'></i>
                    <span>Logout</span>
                </a>
            </div>
        </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <div class="main">
        
        <!-- TOPBAR harmonisÃ©e -->
        <header class="topbar">
            <div class="topbar-left">
                <div class="page-title">
                    <!-- <h1>{% block page_heading %}{% endblock %}</h1>-->
                    <nav class="breadcrumb">
                        <a href="{{ url_for('dashboard') }}">Home</a>
                        <span class="divider">/</span>
                        {% block breadcrumb %}{% endblock %}
                    </nav>
                </div>
            </div>
            
            <div class="topbar-right">
                <!-- Date Widget -->
                <div class="date-widget">
                    <i class='bx bxs-calendar'></i>
                    <span id="current-date">{{ current_date|default('04 Feb 2026') }}</span>
                </div>
                
                <!-- User Widget (simple) -->
                <div class="user-widget">
                    <img src="{{ session.get('avatar_url', 'https://i.pravatar.cc/40') }}" 
                         class="user-avatar" 
                         alt="{{ session.get('user_name', 'User') }}">
                    <div class="user-info">
                        <span class="user-name">{{ session.get('user_name', 'Administrator') }}</span>
                        <span class="user-role">{{ session.get('user_role', 'Admin') }}</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- PAGE CONTENT -->
        <section class="page-content">
            {% block content %}{% endblock %}
        </section>
        
    </div>
</div>

<!-- JavaScript -->
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
<script>
// Date dynamique
document.addEventListener('DOMContentLoaded', function() {
    const now = new Date();
    const options = { day: '2-digit', month: 'short', year: 'numeric' };
    const dateElement = document.getElementById('current-date');
    if (dateElement) {
        dateElement.textContent = now.toLocaleDateString('en-GB', options);
    }
});
</script>

{% block extra_js %}{% endblock %}
</body>
</html>